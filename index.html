<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reading Buddy Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background:#f4f8f3; padding:20px; }
    button { padding:10px 16px; font-size:16px; margin:5px; }
    #story { margin:20px 0; font-size:18px; }
    #status { margin-top:10px; font-weight:bold; }
  </style>
</head>
<body>

<h1>ğŸ“˜ Reading Buddy (Test Build)</h1>
<p>Current Level: <span id="level">1</span></p>

<div id="story">
  The cat sat on the mat. The cat was happy.
</div>

<button onclick="startReading()">ğŸ¤ Start Reading</button>
<button onclick="stopReading()">â¹ Stop</button>

<div id="status"></div>

<script>
let level = 1;
let targetText = document.getElementById("story").innerText.toLowerCase();
let transcript = "";

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
let recognition;

if (SpeechRecognition) {
  recognition = new SpeechRecognition();
  recognition.continuous = true;
  recognition.interimResults = true;

  recognition.onresult = (event) => {
    transcript = "";
    for (let i = 0; i < event.results.length; i++) {
      transcript += event.results[i][0].transcript + " ";
    }
    document.getElementById("status").innerText = "Listening...";
  };

  recognition.onend = () => {
    scoreReading();
  };
} else {
  document.getElementById("status").innerText = "Speech recognition not supported.";
}

function startReading() {
  transcript = "";
  recognition.start();
  document.getElementById("status").innerText = "ğŸ§ Listening...";
}

function stopReading() {
  recognition.stop();
}

function scoreReading() {
  const spoken = transcript.toLowerCase().trim();
  let correctWords = 0;
  targetText.split(" ").forEach(word => {
    if (spoken.includes(word)) correctWords++;
  });

  const accuracy = Math.round((correctWords / targetText.split(" ").length) * 100);
  document.getElementById("status").innerText =
    `Accuracy: ${accuracy}%`;

  if (accuracy >= 80) {
    level++;
    document.getElementById("level").innerText = level;
    document.getElementById("story").innerText =
      "The dog ran in the park. The dog played with a ball.";
    targetText = document.getElementById("story").innerText.toLowerCase();
    document.getElementById("status").innerText += " ğŸ‰ Level up!";
  }
}
</script>

</body>
</html>
